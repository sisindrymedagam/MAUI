<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="YTShorts.MAUI.Pages.ShortsPage"
             xmlns:ctk="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             Title="Shorts"
             xmlns:icon="http://www.aathifmahir.com/dotnet/2022/maui/icons"
             Shell.NavBarIsVisible="False" 
             Shell.FlyoutItemIsVisible="False" 
             Shell.TabBarIsVisible="False" BackgroundColor="Black">

    <Grid BackgroundColor="Black" x:Name="RootGrid">
        <Grid VerticalOptions="Center"
          HorizontalOptions="Center"
              HeightRequest="{Binding Source={x:Reference RootGrid}, Path=Height}"
          WidthRequest="{Binding Source={x:Reference RootGrid}, Path=Height, Converter={StaticResource AspectRatioConverter}, ConverterParameter=9:16}">
            <!-- Full screen video -->
            <ctk:MediaElement x:Name="Player"
                          Source="{Binding CurrentVideo.URL}"
                          ShouldAutoPlay="True"
                          ShouldLoopPlayback="True"
                          ShouldShowPlaybackControls="False"
                          Aspect="AspectFill"
                          VerticalOptions="Fill"
                          HorizontalOptions="Fill" />
        </Grid>

        <!-- Custom transparent toolbar overlay -->
        <Grid VerticalOptions="Start"
              BackgroundColor="#66000000"
            Padding="10"
              HeightRequest="50">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Title -->
            <Label Text="Shorts"
                   TextColor="White"
                   FontAttributes="Bold"
                   FontSize="18"
                   VerticalOptions="Center" />

            <!-- Settings button -->
            <ImageButton Grid.Column="1"
                         Source="{icon:Fluent Icon=Settings16, IconSize=16, IconColor={AppThemeBinding Light=#FFFFFF, Dark=#FFFFFF }}"
                         BackgroundColor="Transparent"
                         Command="{Binding NavigateSettingsCommand}"
                         WidthRequest="16"
                         HeightRequest="16"
                         VerticalOptions="Center"
                         HorizontalOptions="End"/>
        </Grid>

        <!-- Overlay bottom details -->
        <Grid VerticalOptions="End"
              BackgroundColor="Transparent">

            <!-- Gradient for readability -->
            <BoxView HeightRequest="120"
                     VerticalOptions="End"
                     Opacity="0.5">
                <BoxView.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="Transparent" Offset="0.0" />
                        <GradientStop Color="#000000" Offset="1.0" />
                    </LinearGradientBrush>
                </BoxView.Background>
            </BoxView>

            <!-- Text overlay -->
            <VerticalStackLayout VerticalOptions="End" Padding="10">
                <Label Text="{Binding CurrentVideo.Name}"
                       TextColor="White"
                       FontSize="14"
                       Padding="10"
                       FontAttributes="Bold"
                       LineBreakMode="TailTruncation" />
            </VerticalStackLayout>
        </Grid>
        <!-- Attach swipe gestures to Grid (not ContentPage) -->
        <Grid.GestureRecognizers>
            <SwipeGestureRecognizer Direction="Up" Command="{Binding NextCommand}" />
            <SwipeGestureRecognizer Direction="Down" Command="{Binding PreviousCommand}" />
        </Grid.GestureRecognizers>
    </Grid>

    <!--<ContentPage.ToolbarItems>
        -->
    <!--<ToolbarItem Text="Add Password" Clicked="OnAddTapped" Order="Primary" ToolTipProperties.Text="Add Password" />-->
    <!--
        <ToolbarItem Text="Settings" Order="Secondary" Command="{Binding NavigateSettingsCommand}" ToolTipProperties.Text="Settings" />
    </ContentPage.ToolbarItems>-->
</ContentPage>